
@{
    ViewBag.Title = "GetDataFormDraftedOrder";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style type="text/css">
    input[type=text] {
        border-bottom: 1px solid #ccc !important;
    }

    .for_label_styling form {
        width: 66%;
        margin-top: 7px;
        margin-bottom: -40px;
        z-index: 1;
        margin-left: 191px;
    }

    .text_right {
        width: 80%;
    }

    .top-title h2 {
        margin-bottom: -13px;
    }

    .dtr-inline {
        min-height: 0px !important;
    }

    .ordpopup {
        position: fixed;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.3);
        z-index: 2;
        display: none;
        transition: all 0.5s ease-in-out 0s;
        -webkit-transition: all 0.5s ease-in-out 0s;
    }

        .ordpopup .ordpopupinner {
            background: #fff;
            width: 70%;
            padding: 20px 10px;
            position: absolute;
            top: 40%;
            left: 50%;
            border-radius: 6px;
            transform: translate(-50%,-50%);
            border: 1px solid #ccc;
        }

            .ordpopup .ordpopupinner .popupdata {
                position: relative;
                display: block;
                width: 100%;
            }

                .ordpopup .ordpopupinner .popupdata a {
                    position: absolute;
                    top: -37px;
                    right: -23px;
                    background: #f00;
                    color: #fff;
                    font-size: 20px;
                    text-transform: uppercase;
                    border-radius: 30px;
                    padding: 4px 13px;
                    box-shadow: 0px 0px 3px rgba(0,0,0,0.3);
                }

    .for-center {
        margin-top: 40px !important;
    }

    table.dataTable.no-footer {
        min-height: 0 !important;
    }

    table.dataTable tbody td {
        padding: 5px 17px !important;
        vertical-align: middle !important;
    }
</style>

<div class="wrapper">
    <div class="top-title"><h2>Get Drafted Order Details</h2></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 padding-zero ">

                <div class="">
                    <div class="order_table_bg" style="overflow-x:auto;">
                        <table id="tbldraft" class="table order_table for-center hover cell-border order-column amountarightalign">

                            <thead>
                                <tr>
                                    <th>Sr No</th>
                                    <th>Order No</th>
                                    <th>Order Date</th>
                                    <th>Customer</th>
                                    <th>Order Type</th>
                                    <th style="text-align:right">Total Amount</th>
                                    <th> </th>
                                </tr>


                            </thead>
                            <tbody id="tbdydr"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

            $(function
      View_ButtonClick() {
                $('#tbdydr').html('');
                var tblStore = $('#tbdydr');
                $.ajax({
                    type: "GET",
                    crossDomain: true,
                    dataType: 'json',
                    url: '/ViewDraft/GetData',
                    success: function (response) {

                        var table = $('#tbldraft').DataTable();
                        //clear datatable
                        table.clear().draw();
                        //destroy datatable
                        table.destroy();
                        $.each(response, function (index, val) {
                            debugger;
                            trData = $('<tr><td data-rt-label="Sr No">' + val['SrNo'] + '</td><td data-rt-label="Order No">' + val['WebOrderNo'] + '</td><td data-rt-label="Order Date">' + val['OrderDate'] + '</td><td data-rt-label="Customer">' + val['AccountNum'] + '</td><td data-rt-label="User Type">' + val['OrderType'] + '</td><td data-rt-label="Total Amount">' + val['TotalAmount'].toFixed(2) + '</td><td><a onclick="dialog(\'' + val['WebOrderNo'] + '\',\'' + val['AccountNum'] + '\')">View</a></td></tr>');
                            tblStore.append(trData);
                        });
                    },
                    complete: function () {
                        $('#theadao').show();

                        var table = $('#tbldraft').DataTable({
                            // responsive: true

                            scrollCollapse: true
                            , "bDestroy": true
                          , "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]
                                 , "language": {
                                     "search": ""
                                     , "sLengthMenu": "Display _MENU_ Records"
                                     , "info": "Displaying _START_ to _END_ of _TOTAL_ Records"
                                     , "infoEmpty": "Displaying 0 to 0 of 0 Records"
                                 }
                                 , columnDefs: [{
                                     targets: 0,
                                     className: 'dt-body-center'
                                 }, {
                                     targets: -3,
                                     className: 'dt-body-right'
                                 }]
                        });
                        $('.dataTables_filter input').attr("placeholder", "Search");

                        table.draw();
                    },
                    failure: function (text) {
                        debugger;
                        ShowMessage(text.responseText);
                    },
                    error: function (text, xhr, ajaxOptions, thrownError) {
                        debugger;
                        if (xhr.status === 401) {
                            window.location.href = xhr.Data.LogOnUrl;
                            return;
                        }
                        var table = $('#tbldraft').DataTable();
                        table.clear().draw();
                    }
                });
            });
</script>
<script>

            function dialog(WebOrderNo, AccountNum) {
                $('.loader_overlay, #loading').show();
                var url = "/GenerateOrder/GenerateOrder?WebOrderNo=" + WebOrderNo + "&AccountNum=" + AccountNum + "";
                window.location.href = url;
                    $('.ordpopup').fadeIn();
                }
                function dialogout() {
                    $('.ordpopup').fadeOut();
                }

</script>


